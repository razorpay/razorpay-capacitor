{"version":3,"file":"plugin.js","sources":["esm/web.js"],"sourcesContent":["import { registerPlugin, WebPlugin } from '@capacitor/core';\nexport class CheckoutWeb extends WebPlugin {\n    constructor() {\n        super();\n    }\n    async echo(options) {\n        console.log('ECHO', options);\n        return options;\n    }\n    async open(options) {\n        console.log(options);\n        return new Promise((resolve, reject) => {\n            var _a;\n            var razorpay;\n            //add handlers to options to get the success response\n            var finalOps = options;\n            finalOps['handler'] = function (res) {\n                console.log(res.razorpay_payment_id);\n                resolve({\n                    response: res\n                });\n            };\n            finalOps['modal.ondismiss'] = function () {\n                reject(JSON.stringify({ code: 2, description: 'Payment Canceled by User' }));\n            };\n            var retryCount = 0;\n            if (finalOps.hasOwnProperty('retry')) {\n                if (finalOps.retry.enabled === true) {\n                    retryCount = finalOps.retry.max_count;\n                }\n            }\n            //get the first script tag in the document\n            var rjs = document.getElementsByTagName('script')[0];\n            //create a HTMLScriptElement object for rzp script injection\n            var rzpjs = document.createElement('script');\n            rzpjs.id = 'rzp-jssdk';\n            rzpjs.setAttribute('src', 'https://checkout.razorpay.com/v1/checkout.js');\n            (_a = rjs.parentNode) === null || _a === void 0 ? void 0 : _a.appendChild(rzpjs);\n            rzpjs.addEventListener('load', () => {\n                try {\n                    razorpay = new window.Razorpay(finalOps);\n                    razorpay.open();\n                    razorpay.on(('payment.failed'), (res) => {\n                        var _a;\n                        retryCount = retryCount - 1;\n                        if (retryCount < 0) {\n                            console.log(res);\n                            (_a = rjs.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(rzpjs);\n                            reject(res.error);\n                        }\n                    });\n                }\n                catch (err) {\n                    reject({\n                        response: err\n                    });\n                }\n            });\n        });\n        // var rjs = document.getElementsByTagName('script')[0]\n        // var razorpay;\n        // var js:HTMLScriptElement = document.createElement('script')\n        // js.id = 'rzp-jssdk'\n        // js.setAttribute('src','https://checkout.razorpay.com/v1/checkout.js')\n        // document.body.appendChild(js);\n        // document.body.appendChild(js);\n        // rjs.parentNode?.appendChild(js)\n        // rjs.addEventListener('load',()=>{\n        //   try{\n        //     razorpay = new (window as any).Razorpay(options)\n        //     razorpay.open()\n        //     razorpay.on('payment.failed',function(response:any){\n        //         console.log('payment failed')\n        //         console.log(response)\n        //     })\n        //   }catch(err){\n        //     document.body.removeChild(js)\n        //     return{\n        //       response: \"Problem opening checkouts\"\n        //     }\n        //   }\n        // })\n        // return {\n        //   response:options.key\n        // }\n    }\n}\nconst Checkout = registerPlugin('Checkout', {\n    web: () => import('./web').then(m => new m.CheckoutWeb())\n});\nexport * from './definitions';\nexport { Checkout };\n//# sourceMappingURL=web.js.map"],"names":["WebPlugin","registerPlugin"],"mappings":"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"}